# Git Workflow Seguro - Kontify+

## ğŸ¯ Reglas de Oro

1. **NUNCA uses `git checkout HEAD --` sin verificar primero**
2. **Commit despuÃ©s de cada fase completada**
3. **Usa branches para features grandes**
4. **Verifica el estado antes de cualquier operaciÃ³n destructiva**

---

## ğŸ“‹ Workflow Diario

### Antes de Empezar a Trabajar

```bash
# 1. Verifica el estado actual
git status

# 2. Si hay cambios sin commit, guÃ¡rdalos
git add .
git commit -m "wip: save progress before starting new work"

# 3. Actualiza desde remoto (si trabajas en equipo)
git pull origin main
```

### Durante el Desarrollo

```bash
# Cada vez que completes una funcionalidad pequeÃ±a:
git add <archivo-modificado>
git commit -m "feat: descripciÃ³n breve del cambio"

# Ejemplos:
git add services/expertApplicationService.ts
git commit -m "feat: add LeadResponse interface"

git add app/experts-lead-detail.tsx
git commit -m "feat: create lead detail screen"
```

### Al Completar una Fase

```bash
# 1. Verifica quÃ© archivos cambiaron
git status

# 2. Revisa los cambios
git diff

# 3. Agrega todos los archivos relacionados
git add services/expertApplicationService.ts
git add app/experts-dashboard.tsx
git add KONTIFY_AUDIT.md

# 4. Commit con mensaje descriptivo
git commit -m "feat: Phase 10 - Lead Management System

- Added LeadResponse interface and LeadStatus type
- Updated ExpertLead with lead management fields
- Implemented lead detail screen
- Added response functionality
- Created leads list with filters
- Updated dashboard integration
"

# 5. Push a remoto (si tienes configurado)
git push origin main
```

---

## ğŸŒ¿ Workflow con Branches (Recomendado para Fases Grandes)

### Crear Branch para Nueva Fase

```bash
# 1. AsegÃºrate de estar en main limpio
git checkout main
git status  # debe decir "working tree clean"

# 2. Crea y cambia a nueva branch
git checkout -b phase-10-lead-management

# 3. Trabaja normalmente, haciendo commits frecuentes
git add .
git commit -m "feat: add lead detail screen"
git commit -m "feat: add response modal"
# ... etc

# 4. Al terminar, vuelve a main y mergea
git checkout main
git merge phase-10-lead-management

# 5. Elimina la branch (opcional)
git branch -d phase-10-lead-management
```

### Si Algo Sale Mal en la Branch

```bash
# Volver a main sin perder cambios
git checkout main

# Los cambios quedan en la branch, puedes volver
git checkout phase-10-lead-management
```

---

## ğŸš¨ Comandos Peligrosos - Usar con PRECAUCIÃ“N

### âŒ NUNCA uses estos sin verificar primero:

```bash
# âŒ Descarta TODOS los cambios no commiteados
git checkout HEAD -- <archivo>
git reset --hard HEAD

# âŒ Elimina archivos no trackeados
git clean -fd
```

### âœ… Alternativas SEGURAS:

```bash
# âœ… Ver quÃ© cambiarÃ­a antes de descartar
git diff <archivo>

# âœ… Guardar cambios temporalmente (sin commit)
git stash save "descripciÃ³n de los cambios"

# âœ… Ver lista de stashes
git stash list

# âœ… Recuperar cambios guardados
git stash apply stash@{0}

# âœ… Descartar cambios de UN archivo especÃ­fico (con confirmaciÃ³n)
git status  # primero verifica
git diff <archivo>  # revisa los cambios
git checkout -- <archivo>  # solo si estÃ¡s SEGURO
```

---

## ğŸ’¾ Sistema de Backups AutomÃ¡ticos

### Script de Backup (PowerShell)

Crea este archivo: `scripts/backup-services.ps1`

```powershell
# Backup de archivos crÃ­ticos
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$backupDir = "backups/$timestamp"

# Crear directorio de backup
New-Item -ItemType Directory -Force -Path $backupDir

# Backup de archivos crÃ­ticos
Copy-Item "services/expertApplicationService.ts" "$backupDir/"
Copy-Item "app/experts-dashboard.tsx" "$backupDir/"
Copy-Item "KONTIFY_AUDIT.md" "$backupDir/"

Write-Host "âœ… Backup creado en: $backupDir"
```

### Uso:

```bash
# Antes de hacer cambios grandes:
.\scripts\backup-services.ps1
```

---

## ğŸ”„ RecuperaciÃ³n de Cambios Perdidos

### Si perdiste cambios recientes:

```bash
# 1. Verifica el reflog (historial de todos los cambios)
git reflog

# 2. Encuentra el commit antes de perder los cambios
# Busca algo como: HEAD@{5}: commit: feat: Phase 8 complete

# 3. Recupera ese commit
git checkout HEAD@{5} -- services/expertApplicationService.ts

# O crea una branch desde ese punto
git checkout -b recovery-branch HEAD@{5}
```

### Si usaste git stash:

```bash
# Ver todos los stashes
git stash list

# Ver contenido de un stash
git stash show -p stash@{0}

# Aplicar un stash
git stash apply stash@{0}
```

---

## ğŸ“Š VerificaciÃ³n Antes de Operaciones Peligrosas

### Checklist de Seguridad:

```bash
# âœ… Paso 1: Verifica el estado
git status

# âœ… Paso 2: Si hay cambios, revÃ­salos
git diff

# âœ… Paso 3: Si son importantes, guÃ¡rdalos
git add .
git commit -m "wip: save before operation"

# âœ… Paso 4: Ahora sÃ­, procede con la operaciÃ³n
```

---

## ğŸ¯ Commits Recomendados por Tipo

### Mensajes de Commit Convencionales:

```bash
# Features nuevas
git commit -m "feat: add lead detail screen"

# Correcciones de bugs
git commit -m "fix: resolve checkout re-rendering issue"

# Refactoring
git commit -m "refactor: extract lead card component"

# DocumentaciÃ³n
git commit -m "docs: update KONTIFY_AUDIT with Phase 10"

# Estilos/formato
git commit -m "style: fix dark theme consistency"

# Tests
git commit -m "test: add lead management tests"

# Work in progress (temporal)
git commit -m "wip: partial implementation of filters"
```

---

## ğŸ”§ ConfiguraciÃ³n Recomendada

### Aliases Ãºtiles:

```bash
# Configurar aliases globales
git config --global alias.st "status"
git config --global alias.co "checkout"
git config --global alias.br "branch"
git config --global alias.ci "commit"
git config --global alias.unstage "reset HEAD --"
git config --global alias.last "log -1 HEAD"
git config --global alias.visual "log --oneline --graph --all"

# Uso:
git st  # en lugar de git status
git visual  # ver historial grÃ¡fico
```

### Auto-stash antes de pull:

```bash
git config --global pull.rebase true
git config --global rebase.autoStash true
```

---

## ğŸ“ Template de Commit para Fases

```bash
git commit -m "feat: Phase X - [Nombre de la Fase]

[DescripciÃ³n breve de quÃ© hace esta fase]

Changes:
- [Cambio 1]
- [Cambio 2]
- [Cambio 3]

Files modified:
- services/expertApplicationService.ts
- app/[nueva-pantalla].tsx
- KONTIFY_AUDIT.md

Testing:
- [CÃ³mo se probÃ³]
"
```

---

## ğŸ“ Resumen de Mejores PrÃ¡cticas

1. âœ… **Commit frecuente** - Cada funcionalidad pequeÃ±a
2. âœ… **Mensajes descriptivos** - Usa formato convencional
3. âœ… **Branches para features** - Aisla cambios grandes
4. âœ… **Verifica antes de descartar** - `git status` y `git diff`
5. âœ… **Usa stash** - Para cambios temporales
6. âœ… **Backups periÃ³dicos** - Script automÃ¡tico
7. âœ… **Push frecuente** - Si tienes remoto configurado
8. âœ… **Reflog es tu amigo** - Recupera casi cualquier cosa

---

## ğŸš€ Inicio RÃ¡pido

```bash
# ConfiguraciÃ³n inicial (una sola vez)
git config --global user.name "Tu Nombre"
git config --global user.email "tu@email.com"

# Workflow diario
git status                    # Verificar estado
git add .                     # Agregar cambios
git commit -m "feat: ..."     # Commit
git push origin main          # Push (si tienes remoto)

# Antes de operaciones peligrosas
git stash save "backup"       # Guardar cambios
# ... hacer operaciÃ³n ...
git stash apply               # Recuperar si es necesario
```

---

**Recuerda:** En caso de duda, siempre es mejor hacer un commit extra que perder trabajo. Los commits se pueden limpiar despuÃ©s con `git rebase -i`, pero el trabajo perdido no se puede recuperar fÃ¡cilmente.
